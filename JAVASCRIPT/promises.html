





/*


































<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <div id="con">
    
  </div>
</body>
</html>

<script>





/*   


What is a promise in javascript ?

 promise is an object that may produce a single value some time in the future: either a resolved 
 value, or 
 a reason that it’s not resolved.
Here also a Promise can have one of three states
fulfilled
rejected
pending




Promises are generally used for easier handling of asynchronous operations.
If the asynchronous operations are successful then the expected result is returned by calling 
the resolve function by the creator of the promise.
 Similarly if there was some unexpected error the reasons is passed on by calling the reject function.

Note- every promise has a PromiseState and PromiseResult.

When we create a promise it initializes in its pending state

We need to find what is the result of the promised 
In order to find, we have  then and catch.
The then function is attached to promise which executes when the promise is resolved. 
It sends the value sent through resolve method as an argument.

The catch function is attached to promise which executes when the promise is rejected. 
It takes the error sent through reject method as an argument.


Promise using async and await

The word “async” before a function means one simple thing: a function always returns a promise. 
Other values are wrapped in a resolved promise automatically.
The keyword await makes JavaScript wait until that promise settles and returns its result.






What is a fetch?
Fetch is a promise based Javascript API for making asynchronous HTTP requests. It is a clean, simple, 
powerful and a flexible API to get/send data from/to a server.

Note- The Response returned by the fetch() method contains the information about 

the request and the response of the network request including headers, status code, and status message

To get the data, we need to attach a then() method to the fetch() method, because fetch methods are 
asynchronous and only returns a Promise if the request is successful or unsuccessful.

Inside the then() method we will provide a callback function to process the response or the blog data
 coming from the server.




 When we get the response from the API endpoint we are getting something called a Response object
  which is of no use to us because we won't be able to work with that.

So We need to convert the Response object into something we can work with, like JSON or a text.

To convert into JSON, there is a method called json() available in the response object.



we can use the catch() method of the promise to intercept any error that is thrown during the 
execution of the request. 
However, no error will be thrown if the request hits the server and comes back, regardless of 
what response was returned by the server
























*/




function getData() {
  //nature of data?

  return true;
}

let myPromise = new Promise(function (resolve, reject) {
  let data = false; //initally we dont have data

  //we are waiting for data

  setTimeout(function () {
    data = getData();

    if (data) {
      resolve('sweets'); //success value
    } else {
      reject('chappal'); //reject value
    }
  }, 3000);
});
//

//if you want to handle success value

// myPromise.then(function (res) {
//   console.log('res:', res);

//   img.src = 'https://media0.giphy.com/media/Q81NcsY6YxK7jxnr4v/200w.webp?cid=ecf05e47du9rfrb5n1wqylpwka83yq4zksqob66dao6h9zsx&rid=200w.webp&ct=g';
// });

// //if you want to handle reject/error value

// myPromise.catch(function (err) {
//   console.log('err:', err);
// });

// myPromise.finally(function () {
//   console.log('ran');
// });

//1st param to promise - callback function

//resolve - success
//reject - failure



















    // fetch data using promise//

    function getdata(){

let url='https://reqres.in/api/users?page=2';
fetch(url).then((response)=>{
    return response.json();
}).then((data)=>{
  console.log(data.data)
  if(data!=undefined){
    asd(data.data)
  }
 
})


}

getdata();




function asd(data){
data.forEach((el)=>{
let box =document.createElement('h1')
box.innerText=el.first_name


document.querySelector('#con').append(box)
})
}




// post request

function postData(){
    url = "http://dummy.restapiexample.com/api/v1/create";
    data = '{"name":"harglry347485945","salary":"123","age":"23"}'
    params = {
        method:'post',
        headers: {
            'Content-Type': 'application/json'
        },
        body: data   // if data is not in string then we have to use stringify
    }
    fetch(url, params).then(response=> response.json())
    .then(data => ok(data.data.age)
    )
}

postData()

function ok(data){
  console.log('data is',data)
}



/*  





let students=[

    {name:"Dhiraj", subject:"Javascript"},
    {name:"Shreya", subject:"Machine-Learning"}
    
    ]


    function enrollstudents(student){

        return new Promise((reslove,reject)=>{

      setTimeout(()=>{
        students.push(student);

        const error=false
        if(!error){
            reslove()
        }else{
            reject()
        }

      },1000)
        })



    }


    function getstudent(){

        setTimeout(function(){   // SETtimeout is also callback function because it is in anothr function
    
       let str=""
       students.forEach(function(student){
        str+= student.name;
       
       })
      //console.log("student fetched")
      // return str;
    },1000)
    
    }
    



    let newstudent={name:"Suraj", subject:"JAVA"};

    enrollstudents(newstudent).then(getstudent).catch(()=>{

        console.log('error occured')
    })















*/

















</script>




